from app.AuthUtil import AuthUtil, decode_token, get_ldap_groups

authutil = AuthUtil()


def test_validate_token():
    try:
        token = "eyJraWQiOiI5VGd5XzNwNWk3dGtySElGTnQ2VGFrVDFRMG1hbWh2TzdFYk5xcHB3dUtJIiwiYWxnIjoiUlMyNTYifQ.eyJ2ZXIiOjEsImp0aSI6IkFULm1aMnEtdnhtV25FeXMyZjQwMUlsbXFaZE1NTUxvVld1eFBfUlNzdGUtTHMub2FyMXN1ZXJ3aWh1M3BRZ2QwaDciLCJpc3MiOiJodHRwczovL2FtZ2VudGVzdC5va3RhcHJldmlldy5jb20vb2F1dGgyL2F1c2pmbHRjenFxZmpOMTZVMGg3IiwiYXVkIjoiYXBpOi8vQW1nZW4tRW50ZXJwcmlzZS1BUEktU2VydmljZXMiLCJpYXQiOjE2NjYxOTM1NDksImV4cCI6MTY2NjE5NzE0OSwiY2lkIjoiMG9hbmFwdTZtaHd2ekl6bHcwaDciLCJ1aWQiOiIwMHUxZDY2emNodHFTa2FSaTBoOCIsInNjcCI6WyJvZmZsaW5lX2FjY2VzcyIsIm9wZW5pZCIsImVtYWlsIiwicHJvZmlsZSJdLCJhdXRoX3RpbWUiOjE2NjQ4MjI2ODEsInN1YiI6ImFsaW5kYXJ0QGFtZ2VuLmNvbSJ9.zpZOMfXdBlwvofYo4NMVj1pqRMtFFBFS4R7TBXWybqCXZY2drMe1J_n-JfHxo7Wge6QsMKBBbsJOxxuboXjser433_l3sjMOo9G1BWm1Jhhu7c4P-jZlYtdaEXl_3u7auiDLm5uloyy4on2ahMmgAFQLlTVbNihHypvJMIL3N8CAVeRZgIMlCeAspt_a1A6-Ogyn7d17l1jWcYdh_5ey7NSXSfMr01ZXVenVGZdGKvvKmqTVLn5X9MZkuqLb6854pyIzuoym69oVL3DWorVWp75PBUBgj34ixuJq0DN77-EP8znFRFG0f-f39DwaIqq9mXy6RxISofUd6o28JafsNw"
        assert authutil.validate_custom(token)
    except Exception as err:
        assert True


def test_decode_token():
    try:
        token = "eyJraWQiOiI5VGd5XzNwNWk3dGtySElGTnQ2VGFrVDFRMG1hbWh2TzdFYk5xcHB3dUtJIiwiYWxnIjoiUlMyNTYifQ.eyJ2ZXIiOjEsImp0aSI6IkFULm1aMnEtdnhtV25FeXMyZjQwMUlsbXFaZE1NTUxvVld1eFBfUlNzdGUtTHMub2FyMXN1ZXJ3aWh1M3BRZ2QwaDciLCJpc3MiOiJodHRwczovL2FtZ2VudGVzdC5va3RhcHJldmlldy5jb20vb2F1dGgyL2F1c2pmbHRjenFxZmpOMTZVMGg3IiwiYXVkIjoiYXBpOi8vQW1nZW4tRW50ZXJwcmlzZS1BUEktU2VydmljZXMiLCJpYXQiOjE2NjYxOTM1NDksImV4cCI6MTY2NjE5NzE0OSwiY2lkIjoiMG9hbmFwdTZtaHd2ekl6bHcwaDciLCJ1aWQiOiIwMHUxZDY2emNodHFTa2FSaTBoOCIsInNjcCI6WyJvZmZsaW5lX2FjY2VzcyIsIm9wZW5pZCIsImVtYWlsIiwicHJvZmlsZSJdLCJhdXRoX3RpbWUiOjE2NjQ4MjI2ODEsInN1YiI6ImFsaW5kYXJ0QGFtZ2VuLmNvbSJ9.zpZOMfXdBlwvofYo4NMVj1pqRMtFFBFS4R7TBXWybqCXZY2drMe1J_n-JfHxo7Wge6QsMKBBbsJOxxuboXjser433_l3sjMOo9G1BWm1Jhhu7c4P-jZlYtdaEXl_3u7auiDLm5uloyy4on2ahMmgAFQLlTVbNihHypvJMIL3N8CAVeRZgIMlCeAspt_a1A6-Ogyn7d17l1jWcYdh_5ey7NSXSfMr01ZXVenVGZdGKvvKmqTVLn5X9MZkuqLb6854pyIzuoym69oVL3DWorVWp75PBUBgj34ixuJq0DN77-EP8znFRFG0f-f39DwaIqq9mXy6RxISofUd6o28JafsNw"
        assert decode_token(token)
    except Exception as err:
        assert True


def test_ldap_groups():
    try:
        token = "eyJraWQiOiI5VGd5XzNwNWk3dGtySElGTnQ2VGFrVDFRMG1hbWh2TzdFYk5xcHB3dUtJIiwiYWxnIjoiUlMyNTYifQ.eyJ2ZXIiOjEsImp0aSI6IkFULm1aMnEtdnhtV25FeXMyZjQwMUlsbXFaZE1NTUxvVld1eFBfUlNzdGUtTHMub2FyMXN1ZXJ3aWh1M3BRZ2QwaDciLCJpc3MiOiJodHRwczovL2FtZ2VudGVzdC5va3RhcHJldmlldy5jb20vb2F1dGgyL2F1c2pmbHRjenFxZmpOMTZVMGg3IiwiYXVkIjoiYXBpOi8vQW1nZW4tRW50ZXJwcmlzZS1BUEktU2VydmljZXMiLCJpYXQiOjE2NjYxOTM1NDksImV4cCI6MTY2NjE5NzE0OSwiY2lkIjoiMG9hbmFwdTZtaHd2ekl6bHcwaDciLCJ1aWQiOiIwMHUxZDY2emNodHFTa2FSaTBoOCIsInNjcCI6WyJvZmZsaW5lX2FjY2VzcyIsIm9wZW5pZCIsImVtYWlsIiwicHJvZmlsZSJdLCJhdXRoX3RpbWUiOjE2NjQ4MjI2ODEsInN1YiI6ImFsaW5kYXJ0QGFtZ2VuLmNvbSJ9.zpZOMfXdBlwvofYo4NMVj1pqRMtFFBFS4R7TBXWybqCXZY2drMe1J_n-JfHxo7Wge6QsMKBBbsJOxxuboXjser433_l3sjMOo9G1BWm1Jhhu7c4P-jZlYtdaEXl_3u7auiDLm5uloyy4on2ahMmgAFQLlTVbNihHypvJMIL3N8CAVeRZgIMlCeAspt_a1A6-Ogyn7d17l1jWcYdh_5ey7NSXSfMr01ZXVenVGZdGKvvKmqTVLn5X9MZkuqLb6854pyIzuoym69oVL3DWorVWp75PBUBgj34ixuJq0DN77-EP8znFRFG0f-f39DwaIqq9mXy6RxISofUd6o28JafsNw"
        assert get_ldap_groups(token)
    except Exception as err:
        assert True
